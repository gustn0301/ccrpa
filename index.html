<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í´ë¼ìš°ë“œ ì±”ë²„ ë°©ì‚¬ì„  íŒ¨í„´ ë¶„ì„ê¸°</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì„¤ì • */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #eef2f7; /* ë¶€ë“œëŸ¬ìš´ ë°ì€ íŒŒë‘-íšŒìƒ‰ ë°°ê²½ */
        }
        #cloudChamber {
            border: 1px solid #374151; /* ì§„í•œ íšŒìƒ‰ í…Œë‘ë¦¬ */
            background-color: #0d0d10; /* ì–´ë‘ìš´ ì±”ë²„ ë°°ê²½ */
            /* ì±”ë²„ì— ì•½ê°„ì˜ ë‚´ë¶€ ê·¸ë¦¼ì íš¨ê³¼ë¥¼ ì£¼ì–´ ê¹Šì´ê°ì„ í‘œí˜„ */
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8), 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: box-shadow 0.3s ease;
        }
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°œì„  */
        .control-button {
            transition: all 0.2s ease;
            transform: translateY(0);
        }
        .control-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden p-6 sm:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2 text-center flex items-center justify-center">
            <svg class="w-8 h-8 mr-3 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1v-3.25m-7.25 0V7.75h14.5V17M12 4v3.75m-4 0h8m-8 0L9 4l-1-1h8l-1 1L12 7.75"></path></svg>
            í´ë¼ìš°ë“œ ì±”ë²„ ë°©ì‚¬ì„  íŒ¨í„´ ë¶„ì„ê¸°
        </h1>
        <p class="text-center text-gray-500 mb-8 text-lg">
            ë°©ì‚¬ì„  ì…ìì˜ ê¶¤ì  íŠ¹ì§•ì„ ì‹œë®¬ë ˆì´ì…˜ì„ í†µí•´ ì‹œê°ì ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.
        </p>

        <!-- í´ë¼ìš°ë“œ ì±”ë²„ ì‹œê°í™” ì˜ì—­ -->
        <div class="flex flex-col items-center mb-10">
            <h2 class="text-2xl font-bold text-gray-700 mb-4">ì±”ë²„ ê´€ì°° ë·°</h2>
            <!-- ìº”ë²„ìŠ¤ì˜ rounded-xlì„ rounded-2xlë¡œ ë³€ê²½í•˜ì—¬ ë¶€ë“œëŸ¬ì›€ì„ ë”í•¨ -->
            <canvas id="cloudChamber" class="w-full max-w-2xl rounded-2xl" width="600" height="400"></canvas>
            <div id="status" class="mt-4 text-gray-700 font-medium bg-gray-100 py-2 px-4 rounded-full shadow-md">ì¤€ë¹„ ì™„ë£Œ. ì…ì ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ì„¸ìš”.</div>
        </div>

        <!-- ì œì–´íŒ ë° ì •ë³´ ì„¹ì…˜ -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <!-- ì œì–´íŒ (2/5 ë„ˆë¹„) -->
            <div class="lg:col-span-2 bg-indigo-50 p-6 rounded-2xl shadow-lg border border-indigo-100">
                <h2 class="text-xl font-extrabold text-indigo-700 mb-4 border-b pb-2 border-indigo-200">
                    ğŸš€ ì…ì ìƒì„± ì»¨íŠ¸ë¡¤
                </h2>
                
                <div class="space-y-4">
                    <button id="btnAlpha" data-type="alpha" class="control-button w-full py-3 px-4 rounded-xl font-bold text-lg shadow-xl bg-red-600 hover:bg-red-700 text-white flex items-center justify-center">
                        <span class="text-xl mr-2">Î±</span> ì•ŒíŒŒ (Alpha)
                    </button>
                    <button id="btnBeta" data-type="beta" class="control-button w-full py-3 px-4 rounded-xl font-bold text-lg shadow-xl bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center">
                        <span class="text-xl mr-2">Î²</span> ë² íƒ€ (Beta)
                    </button>
                    <button id="btnMuon" data-type="muon" class="control-button w-full py-3 px-4 rounded-xl font-bold text-lg shadow-xl bg-green-600 hover:bg-green-700 text-white flex items-center justify-center">
                        <span class="text-xl mr-2">Î¼</span> ë®¤ì˜¨ / ìš°ì£¼ì„  (Muon)
                    </button>
                </div>

                <button id="btnClear" class="w-full py-3 px-4 mt-6 rounded-xl font-semibold transition duration-300 bg-gray-300 hover:bg-gray-400 text-gray-800 shadow-md flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                    ì±”ë²„ ì´ˆê¸°í™” (Clear)
                </button>
            </div>

            <!-- ì„¤ëª… íŒ¨ë„ (3/5 ë„ˆë¹„) -->
            <div class="lg:col-span-3 bg-white p-6 rounded-2xl shadow-xl border border-gray-100">
                <h2 class="text-xl font-extrabold text-gray-700 mb-4 border-b pb-2">
                    ğŸ” ì…ì íŒ¨í„´ íŠ¹ì§• ë¶„ì„
                </h2>
                <div id="description" class="text-gray-600 space-y-3">
                    <p class="font-bold text-base text-gray-800">ì…ì ìœ í˜•ë³„ ê¶¤ì ì˜ ì£¼ìš” íŠ¹ì§•:</p>
                    <ul class="list-disc list-inside ml-4 space-y-2">
                        <li>
                            <span class="font-bold text-red-600">ì•ŒíŒŒ (Î±):</span>
                            <span class="text-sm">ë†’ì€ ì „í•˜ì™€ ì§ˆëŸ‰ìœ¼ë¡œ ì¸í•´ ì´ì˜¨í™”ë ¥ì´ ë§¤ìš° ê°•í•©ë‹ˆë‹¤. ê¶¤ì ì€ <span class="font-semibold">ë§¤ìš° êµµê³ , ì§§ìœ¼ë©°, ê³§ê²Œ</span> ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì—ë„ˆì§€ë¥¼ ë¹ ë¥´ê²Œ ìƒì–´ë²„ë¦¬ê¸° ë•Œë¬¸ì— ì´ë™ ê±°ë¦¬ê°€ ì§§ìŠµë‹ˆë‹¤.</span>
                        </li>
                        <li>
                            <span class="font-bold text-blue-600">ë² íƒ€ (Î²):</span>
                            <span class="text-sm">ì§ˆëŸ‰ì´ ë§¤ìš° ì‘ì•„ ë¬¼ì§ˆê³¼ ìƒí˜¸ì‘ìš©í•  ë•Œ ì‰½ê²Œ ì‚°ë€ë©ë‹ˆë‹¤. ê¶¤ì ì€ <span class="font-semibold">ë§¤ìš° ê°€ëŠ˜ê³  ê¸¸ë©°, ë¶ˆê·œì¹™í•˜ê²Œ êµ¬ë¶ˆêµ¬ë¶ˆí•œ</span> í˜•íƒœë¥¼ ë³´ì…ë‹ˆë‹¤.</span>
                        </li>
                        <li>
                            <span class="font-bold text-green-600">ë®¤ì˜¨ (Î¼):</span>
                            <span class="text-sm">ìš°ì£¼ì„  ìƒ¤ì›Œì—ì„œ ìœ ë˜í•˜ë©°, ë§¤ìš° ë†’ì€ ì—ë„ˆì§€ë¥¼ ê°€ì§‘ë‹ˆë‹¤. ê¶¤ì ì€ <span class="font-semibold">ë§¤ìš° ê¸¸ê³ , ê±°ì˜ ì™„ë²½í•˜ê²Œ ê³§ê²Œ</span> ì±”ë²„ë¥¼ ê´€í†µí•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.</span>
                        </li>
                    </ul>
                    <p class="italic text-sm text-gray-500 pt-2 border-t mt-3">ì‹œë®¬ë ˆì´ì…˜ì€ ì…ìì˜ ì´ì˜¨í™” ì •ë„ì™€ ì‚°ë€ìœ¨ì„ ê¸°ë°˜ìœ¼ë¡œ ê¶¤ì ì„ ëª¨ë¸ë§í•©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ìƒìˆ˜ ì„¤ì •
        const CANVAS_WIDTH = 600;
        const CANVAS_HEIGHT = 400;
        const TRACK_OPACITY = 0.8;
        const MAX_TRACKS = 10; // ìµœëŒ€ ê¶¤ì  ìˆ˜

        // ìº”ë²„ìŠ¤ ë° Context ê°€ì ¸ì˜¤ê¸°
        const canvas = document.getElementById('cloudChamber');
        const ctx = canvas.getContext('2d');
        
        // UI ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const statusDiv = document.getElementById('status');
        const buttons = document.querySelectorAll('button[data-type]');
        const clearButton = document.getElementById('btnClear');
        const descriptionDiv = document.getElementById('description');

        let tracks = []; // í˜„ì¬ ì±”ë²„ì— ìˆëŠ” ê¶¤ì  ì €ì¥
        let animationFrameId = null;

        // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---

        /**
         * ëœë¤ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
         * @param {number} min - ìµœì†Œê°’
         * @param {number} max - ìµœëŒ€ê°’
         * @returns {number} ëœë¤ ê°’
         */
        function rand(min, max) {
            return Math.random() * (max - min) + min;
        }

        /**
         * ë²¡í„°ì˜ ê¸¸ì´ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
         * @param {number} dx - x ë³€í™”ëŸ‰
         * @param {number} dy - y ë³€í™”ëŸ‰
         * @returns {number} ë²¡í„° ê¸¸ì´
         */
        function length(dx, dy) {
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        // --- ê¶¤ì  í´ë˜ìŠ¤ ---

        class Track {
            /**
             * ë°©ì‚¬ì„  ê¶¤ì ì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤.
             * @param {'alpha'|'beta'|'muon'} type - ì…ì ìœ í˜•
             */
            constructor(type) {
                this.type = type;
                this.color = this._getColor(type);
                this.lineWidth = this._getLineWidth(type);
                this.maxSteps = this._getMaxSteps(type);
                this.steps = 0;
                this.points = [];
                
                // ì´ˆê¸° ìœ„ì¹˜ (ì¤‘ì•™ ë˜ëŠ” ë¬´ì‘ìœ„ ì§„ì…ì )
                // ì…ìê°€ ì±”ë²„ ê°€ì¥ìë¦¬ ê·¼ì²˜ì—ì„œ ì‹œì‘í•˜ì—¬ ì•ˆìœ¼ë¡œ ì´ë™í•˜ë„ë¡ ì„¤ì •
                const side = Math.floor(rand(0, 4)); // 0: top, 1: right, 2: bottom, 3: left
                
                if (side === 0) { // Top
                    this.x = rand(0, CANVAS_WIDTH);
                    this.y = 0;
                } else if (side === 1) { // Right
                    this.x = CANVAS_WIDTH;
                    this.y = rand(0, CANVAS_HEIGHT);
                } else if (side === 2) { // Bottom
                    this.x = rand(0, CANVAS_WIDTH);
                    this.y = CANVAS_HEIGHT;
                } else { // Left
                    this.x = 0;
                    this.y = rand(0, CANVAS_HEIGHT);
                }

                // ì´ˆê¸° ì†ë„/ë°©í–¥ì„ ì±”ë²„ ì•ˆìª½ì„ í–¥í•˜ë„ë¡ ì„¤ì •
                let targetX = rand(50, CANVAS_WIDTH - 50);
                let targetY = rand(50, CANVAS_HEIGHT - 50);
                this.vx = targetX - this.x;
                this.vy = targetY - this.y;
                
                // ì†ë„ì˜ í¬ê¸°ë¥¼ ì •ê·œí™”í•˜ì—¬ ì¼ì •í•œ ì´ë™ ì†ë„ë¥¼ ìœ ì§€
                const speed = this._getSpeed(type);
                const currentSpeed = length(this.vx, this.vy);
                // currentSpeedê°€ 0ì¸ ê²½ìš° ë°©ì§€
                if (currentSpeed > 0) {
                    this.vx = (this.vx / currentSpeed) * speed;
                    this.vy = (this.vy / currentSpeed) * speed;
                } else {
                    // ì˜ˆì™¸ ì²˜ë¦¬: ì†ë„ë¥¼ ëœë¤í•˜ê²Œ ì¬ì„¤ì •
                    this.vx = rand(-speed, speed);
                    this.vy = rand(-speed, speed);
                }

                this.points.push({ x: this.x, y: this.y });
            }

            /** ì…ì ìœ í˜•ì— ë”°ë¥¸ ìƒ‰ìƒ ë°˜í™˜ */
            _getColor(type) {
                switch (type) {
                    case 'alpha': return 'rgba(255, 87, 87, 1)'; // Red (ì¡°ê¸ˆ ë” ë°ê²Œ)
                    case 'beta': return 'rgba(90, 150, 255, 1)'; // Blue (ì¡°ê¸ˆ ë” ë°ê²Œ)
                    case 'muon': return 'rgba(87, 255, 87, 1)'; // Green (ì¡°ê¸ˆ ë” ë°ê²Œ)
                    default: return 'rgba(200, 200, 200, 1)';
                }
            }

            /** ì…ì ìœ í˜•ì— ë”°ë¥¸ ì„  êµµê¸° ë°˜í™˜ */
            _getLineWidth(type) {
                switch (type) {
                    case 'alpha': return rand(4, 6); // êµµìŒ
                    case 'beta': return rand(1, 1.5); // ë§¤ìš° ì–‡ìŒ
                    case 'muon': return rand(2, 3); // ë³´í†µ
                    default: return 2;
                }
            }

            /** ì…ì ìœ í˜•ì— ë”°ë¥¸ ìµœëŒ€ ìŠ¤í…(ê¶¤ì  ê¸¸ì´) ë°˜í™˜ */
            _getMaxSteps(type) {
                switch (type) {
                    case 'alpha': return Math.floor(rand(15, 40)); // ì§§ìŒ
                    case 'beta': return Math.floor(rand(200, 400)); // ë§¤ìš° ê¹€
                    case 'muon': return Math.floor(rand(600, 1000)); // ë§¤ìš° ê¹€ (ì±”ë²„ ê´€í†µ)
                    default: return 50;
                }
            }

             /** ì…ì ìœ í˜•ì— ë”°ë¥¸ ì†ë„ ë°˜í™˜ (í”½ì…€/í”„ë ˆì„) */
            _getSpeed(type) {
                switch (type) {
                    case 'alpha': return rand(3, 5); 
                    case 'beta': return rand(5, 7); // ë² íƒ€ëŠ” ê°€ë²¼ì›Œì„œ ë” ë¹ ë¦„
                    case 'muon': return rand(6, 8); // ë®¤ì˜¨ì€ ë§¤ìš° ë¹ ë¦„
                    default: return 4;
                }
            }


            /** ë‹¤ìŒ ê¶¤ì  ìœ„ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. */
            update() {
                if (this.isFinished()) return;

                // 1. ë°©í–¥ ë³€í™” (ì‚°ë€)
                let scatterFactor = 0;
                if (this.type === 'beta') {
                    // ë² íƒ€: ë†’ì€ ì‚°ë€ìœ¨ (êµ¬ë¶ˆêµ¬ë¶ˆ)
                    scatterFactor = rand(0.2, 0.6); 
                } else if (this.type === 'alpha') {
                    // ì•ŒíŒŒ: ë‚®ì€ ì‚°ë€ìœ¨ (ê³§ìŒ)
                    scatterFactor = rand(0.01, 0.05);
                } else if (this.type === 'muon') {
                     // ë®¤ì˜¨: ê±°ì˜ ì‚°ë€ ì—†ìŒ (ë§¤ìš° ê³§ìŒ)
                    scatterFactor = rand(0.005, 0.015);
                }
                
                // ë¬´ì‘ìœ„ ë°©í–¥ ë³€í™”
                this.vx += rand(-scatterFactor, scatterFactor);
                this.vy += rand(-scatterFactor, scatterFactor);

                // ì†ë„ ì •ê·œí™”: ì†ë„ì˜ í¬ê¸°ë¥¼ ì¼ì •í•˜ê²Œ ìœ ì§€
                const speed = this._getSpeed(this.type);
                const currentSpeed = length(this.vx, this.vy);
                this.vx = (this.vx / currentSpeed) * speed;
                this.vy = (this.vy / currentSpeed) * speed;

                // 2. ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                this.x += this.vx;
                this.y += this.vy;
                this.points.push({ x: this.x, y: this.y });

                this.steps++;
            }

            /** ê¶¤ì ì„ ìº”ë²„ìŠ¤ì— ê·¸ë¦½ë‹ˆë‹¤. */
            draw() {
                if (this.points.length < 2) return;

                // ê¶¤ì ì˜ íˆ¬ëª…ë„ëŠ” ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ê°ì†Œí•˜ì—¬ ê¼¬ë¦¬ íš¨ê³¼ë¥¼ ì¤ë‹ˆë‹¤.
                const tailLength = Math.min(this.points.length, 60); // ê¼¬ë¦¬ ê¸¸ì´ë¥¼ ëŠ˜ë ¤ ì”ìƒ íš¨ê³¼ ê°•í™”
                
                ctx.beginPath();
                ctx.lineCap = 'round';
                ctx.lineWidth = this.lineWidth;

                for (let i = 0; i < this.points.length - 1; i++) {
                    const start = this.points[i];
                    const end = this.points[i + 1];
                    
                    // ê¶¤ì ì˜ ë ë¶€ë¶„ì¼ìˆ˜ë¡ íˆ¬ëª…ë„ë¥¼ ë†’ì—¬ í¬ë¯¸í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.
                    // í˜„ì¬ ìœ„ì¹˜ì— ê°€ê¹Œìš¸ìˆ˜ë¡ (iê°€ í´ìˆ˜ë¡) ë” ì§„í•˜ê²Œ í‘œì‹œ
                    const opacity = TRACK_OPACITY * (i / (this.points.length - 1));
                    
                    // ìƒ‰ìƒ ë¬¸ìì—´ì—ì„œ ì•ŒíŒŒê°’ì„ ë³€ê²½í•©ë‹ˆë‹¤.
                    const colorBase = this.color.slice(0, -2); 
                    ctx.strokeStyle = `${colorBase}${opacity})`;

                    ctx.beginPath();
                    ctx.moveTo(start.x, start.y);
                    ctx.lineTo(end.x, end.y);
                    ctx.stroke();
                }
            }

            /** ê¶¤ì  ìƒì„±ì´ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. */
            isFinished() {
                // ìµœëŒ€ ìŠ¤í…ì— ë„ë‹¬í–ˆê±°ë‚˜ ì±”ë²„ ë°–ìœ¼ë¡œ ë‚˜ê°”ëŠ”ì§€ í™•ì¸
                const outOfBounds = this.x < -10 || this.x > CANVAS_WIDTH + 10 || this.y < -10 || this.y > CANVAS_HEIGHT + 10;
                
                return this.steps >= this.maxSteps || outOfBounds;
            }
        }

        // --- ë©”ì¸ ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---

        /**
         * ìƒˆë¡œìš´ ê¶¤ì ì„ ìƒì„±í•˜ê³  ë°°ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤.
         * @param {'alpha'|'beta'|'muon'} type - ì…ì ìœ í˜•
         */
        function generateTrack(type) {
            if (tracks.length >= MAX_TRACKS) {
                // ê°€ì¥ ì˜¤ë˜ëœ ê¶¤ì (ì²« ë²ˆì§¸ ê¶¤ì ) ì œê±°
                tracks.shift(); 
            }
            const newTrack = new Track(type);
            tracks.push(newTrack);
            updateStatus(`ìƒˆë¡œìš´ <span class="font-bold text-indigo-600">${newTrack.type.toUpperCase()}</span> ì…ì ê¶¤ì  ìƒì„±!`);
            startAnimationLoop();
        }

        /** ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„ë¥¼ ì‹œì‘/ì¬ì‹œì‘í•©ë‹ˆë‹¤. */
        function startAnimationLoop() {
            if (animationFrameId !== null) {
                cancelAnimationFrame(animationFrameId);
            }
            animate();
        }

        /** ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„ */
        function animate() {
            // ì±”ë²„ ì´ˆê¸°í™” (íˆ¬ëª…ë„ë¥¼ ë‚®ì¶° ì´ì „ ê¶¤ì  ì”ìƒ íš¨ê³¼)
            ctx.fillStyle = 'rgba(13, 13, 16, 0.05)'; // ë°°ê²½ìƒ‰ (0d0d10)ì˜ ë‚®ì€ íˆ¬ëª…ë„
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            let activeTracks = false;

            // ëª¨ë“  ê¶¤ì  ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
            for (let i = tracks.length - 1; i >= 0; i--) {
                const track = tracks[i];
                if (!track.isFinished()) {
                    track.update();
                    activeTracks = true;
                }
                track.draw();
            }

            // ëª¨ë“  ê¶¤ì ì´ ì™„ë£Œë˜ê±°ë‚˜ ê¶¤ì ì´ ë‚¨ì•„ìˆìœ¼ë©´ ê³„ì† ì• ë‹ˆë©”ì´ì…˜
            if (activeTracks || tracks.length > 0) {
                 animationFrameId = requestAnimationFrame(animate);
            } else {
                animationFrameId = null;
                updateStatus('ì±”ë²„ ì´ˆê¸°í™”ë¨.');
            }
        }

        /** ìº”ë²„ìŠ¤ë¥¼ ì§€ìš°ê³  ëª¨ë“  ê¶¤ì ì„ ì œê±°í•©ë‹ˆë‹¤. */
        function clearChamber() {
            cancelAnimationFrame(animationFrameId);
            animationFrameId = null;
            // ì±”ë²„ ì „ì²´ë¥¼ ë‹¤ì‹œ ì–´ë‘¡ê²Œ ì±„ì›ë‹ˆë‹¤.
            ctx.fillStyle = '#0d0d10';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            tracks = [];
            updateStatus('ì±”ë²„ê°€ ê¹¨ë—í•˜ê²Œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        /** ìƒíƒœ ë©”ì‹œì§€ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. */
        function updateStatus(message) {
            statusDiv.innerHTML = message;
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---

        // ì…ì ìƒì„± ë²„íŠ¼ ì´ë²¤íŠ¸
        buttons.forEach(button => {
            button.addEventListener('click', (e) => {
                const type = e.currentTarget.dataset.type;
                generateTrack(type);
            });
        });

        // ì´ˆê¸°í™” ë²„íŠ¼ ì´ë²¤íŠ¸
        clearButton.addEventListener('click', clearChamber);

        // ì´ˆê¸° ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì • (ë°˜ì‘í˜• ëŒ€ì‘)
        window.addEventListener('load', () => {
             // ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ DOM ìš”ì†Œ í¬ê¸°ì— ë§ê²Œ ì„¤ì •
             const containerWidth = canvas.parentElement.clientWidth;
             canvas.width = containerWidth;
             canvas.height = containerWidth * (400 / 600); // 3:2 ë¹„ìœ¨ ìœ ì§€ (400/600)
             clearChamber(); // ì´ˆê¸°ì—ëŠ” ì±”ë²„ë¥¼ ê²€ì€ìƒ‰ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.

             // í¬ê¸° ë³€ê²½ ì‹œ ì±”ë²„ ì´ˆê¸°í™”
             window.addEventListener('resize', () => {
                 const newContainerWidth = canvas.parentElement.clientWidth;
                 canvas.width = newContainerWidth;
                 canvas.height = newContainerWidth * (400 / 600);
                 clearChamber();
             });
        });

    </script>

</body>
</html>
